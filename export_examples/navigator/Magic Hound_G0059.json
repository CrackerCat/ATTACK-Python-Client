{"description": "Enterprise techniques used by Magic Hound, ATT&CK group G0059 v1.0", "name": "Magic Hound (G0059)", "domain": "mitre-enterprise", "version": "3.0", "techniques": [{"score": 1, "techniqueID": "T1566.003", "techniqueName": "Spearphishing via Service", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) used various social media channels to spearphish victims.(Citation: FireEye Operation Saffron Rose 2013)(Citation: SecureWorks Mia Ash July 2017)(Citation: Microsoft Phosphorus Mar 2019)"}, {"score": 1, "techniqueID": "T1204.002", "techniqueName": "Malicious File", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) has lured victims into executing malicious files.(Citation: FireEye Operation Saffron Rose 2013)"}, {"score": 1, "techniqueID": "T1555.003", "techniqueName": "Credentials from Web Browsers", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) used FireMalv, custom-developed malware, which collected passwords from the Firefox browser storage.(Citation: Check Point Rocket Kitten)"}, {"score": 1, "techniqueID": "T1566.001", "techniqueName": "Spearphishing Attachment", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) has used personalized spearphishing attachments.(Citation: Check Point Rocket Kitten)"}, {"score": 1, "techniqueID": "T1571", "techniqueName": "Non-Standard Port", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) malware has communicated with its C2 server over TCP port 4443 using HTTP.(Citation: Unit 42 Magic Hound Feb 2017)"}, {"score": 1, "techniqueID": "T1098.002", "techniqueName": "Exchange Email Delegate Permissions", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) granted compromised email accounts read access to the email boxes of additional targeted accounts. The group then was able to authenticate to the intended victim's OWA (Outlook Web Access) portal and read hundreds of email communications for information on Middle East organizations.(Citation: FireEye APT35 2018) "}, {"score": 1, "techniqueID": "T1071", "techniqueName": "Application Layer Protocol", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) malware has used IRC for C2.(Citation: Unit 42 Magic Hound Feb 2017)"}, {"score": 1, "techniqueID": "T1564.003", "techniqueName": "Hidden Window", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) malware has a function to determine whether the C2 server wishes to execute the newly dropped file in a hidden window.(Citation: Unit 42 Magic Hound Feb 2017)"}, {"score": 1, "techniqueID": "T1114.001", "techniqueName": "Local Email Collection", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) has collected .PST archives.(Citation: FireEye APT35 2018)"}, {"score": 1, "techniqueID": "T1560.001", "techniqueName": "Archive via Utility", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) has used RAR to stage and compress local folders.(Citation: FireEye APT35 2018)"}, {"score": 1, "techniqueID": "T1003.001", "techniqueName": "LSASS Memory", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) stole domain credentials from Microsoft Active Directory Domain Controller and leveraged [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: FireEye APT35 2018)"}, {"score": 1, "techniqueID": "T1566.002", "techniqueName": "Spearphishing Link", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) sent shortened URL links over email to victims. The URLs linked to Word documents with malicious macros that execute PowerShells scripts to download Pupy."}, {"score": 1, "techniqueID": "T1105", "techniqueName": "Ingress Tool Transfer", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) has downloaded additional code and files from servers onto victims.(Citation: Unit 42 Magic Hound Feb 2017) [Magic Hound](https://attack.mitre.org/groups/G0059) used Wrapper/Gholee, custom-developed malware, which downloaded additional malware to the infected system.(Citation: Check Point Rocket Kitten)(Citation: Check Point Rocket Kitten)"}, {"score": 1, "techniqueID": "T1059.005", "techniqueName": "Visual Basic", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) malware has used VBS scripts for execution.(Citation: Unit 42 Magic Hound Feb 2017)"}, {"score": 1, "techniqueID": "T1043", "techniqueName": "Commonly Used Port", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) malware has communicated with C2 servers over port 6667 (for IRC) and port 8080.(Citation: Unit 42 Magic Hound Feb 2017)"}, {"score": 1, "techniqueID": "T1083", "techniqueName": "File and Directory Discovery", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) malware can list a victim's logical drives and the type, as well the total/free space of the fixed devices. Other malware can list a directory's contents.(Citation: Unit 42 Magic Hound Feb 2017)"}, {"score": 1, "techniqueID": "T1059.003", "techniqueName": "Windows Command Shell", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) has used the command-line interface.(Citation: Unit 42 Magic Hound Feb 2017)"}, {"score": 1, "techniqueID": "T1027", "techniqueName": "Obfuscated Files or Information", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) malware has used base64-encoded commands and files, and has also encrypted embedded strings with AES.(Citation: Unit 42 Magic Hound Feb 2017)"}, {"score": 1, "techniqueID": "T1033", "techniqueName": "System Owner/User Discovery", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) malware has obtained the victim username and sent it to the C2 server.(Citation: Unit 42 Magic Hound Feb 2017)"}, {"score": 1, "techniqueID": "T1082", "techniqueName": "System Information Discovery", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) malware has used a PowerShell command to check the victim system architecture to determine if it is an x64 machine. Other malware has obtained the OS version, UUID, and computer/host name to send to the C2 server.(Citation: Unit 42 Magic Hound Feb 2017)"}, {"score": 1, "techniqueID": "T1016", "techniqueName": "System Network Configuration Discovery", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) malware gathers the victim's local IP address, MAC address, and external IP address.(Citation: Unit 42 Magic Hound Feb 2017)"}, {"score": 1, "techniqueID": "T1065", "techniqueName": "Uncommonly Used Port", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) malware has communicated with its C2 server over ports 4443 and 3543.(Citation: Unit 42 Magic Hound Feb 2017)"}, {"score": 1, "techniqueID": "T1070.004", "techniqueName": "File Deletion", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) has deleted and overwrote files to cover tracks.(Citation: Unit 42 Magic Hound Feb 2017)(Citation: FireEye APT35 2018)"}, {"score": 1, "techniqueID": "T1102.002", "techniqueName": "Bidirectional Communication", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) malware can use a SOAP Web service to communicate with its C2 server.(Citation: Unit 42 Magic Hound Feb 2017)"}, {"score": 1, "techniqueID": "T1547.001", "techniqueName": "Registry Run Keys / Startup Folder", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) malware has used Registry Run keys to establish persistence.(Citation: Unit 42 Magic Hound Feb 2017)"}, {"score": 1, "techniqueID": "T1059.001", "techniqueName": "PowerShell", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) has used PowerShell for execution and privilege escalation.(Citation: Unit 42 Magic Hound Feb 2017)(Citation: FireEye APT35 2018)"}, {"score": 1, "techniqueID": "T1056.001", "techniqueName": "Keylogging", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) malware is capable of keylogging.(Citation: Unit 42 Magic Hound Feb 2017) [Magic Hound](https://attack.mitre.org/groups/G0059) used CWoolger and MPK, custom-developed malware, which recorded all keystrokes on an infected system.(Citation: Check Point Rocket Kitten)"}, {"score": 1, "techniqueID": "T1057", "techniqueName": "Process Discovery", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) malware can list running processes.(Citation: Unit 42 Magic Hound Feb 2017)"}, {"score": 1, "techniqueID": "T1071.001", "techniqueName": "Web Protocols", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) malware has used HTTP for C2.(Citation: Unit 42 Magic Hound Feb 2017)"}, {"score": 1, "techniqueID": "T1113", "techniqueName": "Screen Capture", "comment": "[Magic Hound](https://attack.mitre.org/groups/G0059) malware can take a screenshot and upload the file to its C2 server.(Citation: Unit 42 Magic Hound Feb 2017)"}], "gradient": {"colors": ["#ffffff", "#ff6666"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by Magic Hound", "color": "#ff6666"}]}