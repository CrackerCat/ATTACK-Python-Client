{"description": "Enterprise techniques used by Dragonfly 2.0, ATT&CK group G0074 v1.0", "name": "Dragonfly 2.0 (G0074)", "domain": "mitre-enterprise", "version": "3.0", "techniques": [{"score": 1, "techniqueID": "T1003.004", "techniqueName": "LSA Secrets", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) dropped and executed SecretsDump to dump password hashes.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)(Citation: Core Security Impacket)"}, {"score": 1, "techniqueID": "T1003.003", "techniqueName": "NTDS", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) dropped and executed SecretsDump to dump password hashes. They also obtained ntds.dit from domain controllers. (Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)(Citation: Core Security Impacket)"}, {"score": 1, "techniqueID": "T1059.006", "techniqueName": "Python", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used various types of scripting to perform operations, including Python scripts. The group was observed installing Python 2.7 on a victim.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1204.001", "techniqueName": "Malicious Link", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has used various forms of spearphishing in attempts to get users to open links.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1562.004", "techniqueName": "Disable or Modify System Firewall", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has disabled host-based firewalls. The group has also globally opened port 3389.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1112", "techniqueName": "Modify Registry", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) modified the Registry to perform multiple techniques through the use of [Reg](https://attack.mitre.org/software/S0075).(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1018", "techniqueName": "Remote System Discovery", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) likely obtained a list of hosts in the victim environment.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1204.002", "techniqueName": "Malicious File", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has used various forms of spearphishing in attempts to get users to open attachments.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1071", "techniqueName": "Application Layer Protocol", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used SMB for C2.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1221", "techniqueName": "Template Injection", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has injected SMB URLs into malicious Word spearphishing attachments to initiate [Forced Authentication](https://attack.mitre.org/techniques/T1187).(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1003.002", "techniqueName": "Security Account Manager", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) dropped and executed SecretsDump to dump password hashes.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1135", "techniqueName": "Network Share Discovery", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) identified and browsed file servers in the victim network, sometimes , viewing files pertaining to ICS or Supervisory Control and Data Acquisition (SCADA) systems.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1078", "techniqueName": "Valid Accounts", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) compromised user credentials and used valid accounts for operations.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1083", "techniqueName": "File and Directory Discovery", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used a batch script to gather folder and file names from victim hosts.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1036", "techniqueName": "Masquerading", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) created accounts disguised as legitimate backup and service accounts as well as an email administration account.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1069.002", "techniqueName": "Domain Groups", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used batch scripts to enumerate administrators and users in the domain.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1189", "techniqueName": "Drive-by Compromise", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) compromised legitimate organizations' websites to create watering holes to compromise victims.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1005", "techniqueName": "Data from Local System", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) collected data from local victim systems.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1187", "techniqueName": "Forced Authentication", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has gathered hashed user credentials over SMB using spearphishing attachments with external resource links and by modifying .LNK file icon resources to collect credentials from virtualized systems.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1059", "techniqueName": "Command and Scripting Interpreter", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used command line for execution.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1136.001", "techniqueName": "Local Account", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) created accounts on victims, including administrator accounts, some of which appeared to be tailored to each individual staging target.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1114.002", "techniqueName": "Remote Email Collection", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) accessed email accounts using Outlook Web Access.(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1070.001", "techniqueName": "Clear Windows Event Logs", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) cleared Windows event logs and other logs produced by tools they used, including system, security, terminal services, remote services, and audit logs. The actors also deleted specific Registry keys.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1053.005", "techniqueName": "Scheduled Task", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used scheduled tasks to automatically log out of created accounts every 8 hours as well as to execute malicious files.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1012", "techniqueName": "Query Registry", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) queried the Registry to identify victim information.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1059.003", "techniqueName": "Windows Command Shell", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used various types of scripting to perform operations, including batch scripts.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1070.004", "techniqueName": "File Deletion", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) deleted many of its files used during operations as part of cleanup, including removing applications and deleting screenshots.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1105", "techniqueName": "Ingress Tool Transfer", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) copied and installed tools for operations once in the victim environment.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1113", "techniqueName": "Screen Capture", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has performed screen captures of victims, including by using a tool, scr.exe (which matched the hash of ScreenUtil).(Citation: US-CERT TA18-074A)(Citation: Symantec Dragonfly Sept 2017)"}, {"score": 1, "techniqueID": "T1016", "techniqueName": "System Network Configuration Discovery", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used batch scripts to enumerate network information, including information about trusts, zones, and the domain.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1505.003", "techniqueName": "Web Shell", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) commonly created Web shells on victims' publicly accessible email and web servers, which they used to maintain access to a victim network and download additional malicious files.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1566.002", "techniqueName": "Spearphishing Link", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used spearphishing with PDF attachments containing malicious links that redirected to credential harvesting websites.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1547.001", "techniqueName": "Registry Run Keys / Startup Folder", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) added the registry value ntdll to the Registry Run key to establish persistence.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1033", "techniqueName": "System Owner/User Discovery", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used the command <code>query user</code> on victim hosts.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1547.009", "techniqueName": "Shortcut Modification", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) manipulated .lnk files to gather user credentials in conjunction with [Forced Authentication](https://attack.mitre.org/techniques/T1187).(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1566.001", "techniqueName": "Spearphishing Attachment", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used spearphishing with Microsoft Office attachments to target victims.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1059.001", "techniqueName": "PowerShell", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used PowerShell scripts for execution.(Citation: US-CERT TA18-074A)(Citation: Symantec Dragonfly Sept 2017)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1074.001", "techniqueName": "Local Data Staging", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) created a directory named \"out\" in the user's %AppData% folder and copied files to it.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1560", "techniqueName": "Archive Collected Data", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) compressed data into .zip files prior to exfiltrating it.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1110.002", "techniqueName": "Password Cracking", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) dropped and executed tools used for password cracking, including Hydra.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)(Citation: Kali Hydra)"}, {"score": 1, "techniqueID": "T1021.001", "techniqueName": "Remote Desktop Protocol", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) moved laterally via RDP.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1098", "techniqueName": "Account Manipulation", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) added newly created accounts to the administrators group to maintain elevated access.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1087.002", "techniqueName": "Domain Account", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used batch scripts to enumerate users on a victim domain controller.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1133", "techniqueName": "External Remote Services", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used VPNs and Outlook Web Access (OWA) to maintain access to victim networks.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1043", "techniqueName": "Commonly Used Port", "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used SMB over ports 445 or 139 for C2. The group also established encrypted connections over port 443.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}], "gradient": {"colors": ["#ffffff", "#ff6666"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by Dragonfly 2.0", "color": "#ff6666"}]}